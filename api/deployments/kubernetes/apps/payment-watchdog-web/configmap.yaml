apiVersion: v1
kind: ConfigMap
metadata:
  name: payment-watchdog-web-config
  namespace: lexure
  labels:
    app: payment-watchdog
    component: web
    version: v1.0.0
data:
  next.config.js: |
    /** @type {import('next').NextConfig} */
    const nextConfig = {
      reactStrictMode: true,
      swcMinify: true,
      output: 'standalone',
      experimental: {
        outputFileTracingRoot: undefined,
      },
      env: {
        NEXT_PUBLIC_API_URL: process.env.NEXT_PUBLIC_API_URL || 'http://payment-watchdog.lexure.svc.cluster.local',
        NEXT_PUBLIC_DEV_PROXY_BYPASS: process.env.NEXT_PUBLIC_DEV_PROXY_BYPASS || 'true',
        NEXT_PUBLIC_LOCALHOST_BYPASS: process.env.NEXT_PUBLIC_LOCALHOST_BYPASS || 'true',
      },
      async rewrites() {
        return [
          {
            source: '/api/:path*',
            destination: `${process.env.NEXT_PUBLIC_API_URL || 'http://payment-watchdog.lexure.svc.cluster.local'}/api/:path*`,
          },
        ];
      },
    };
    
    module.exports = nextConfig;
